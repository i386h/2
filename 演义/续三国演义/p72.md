<!-- { "loadSidebar": true } -->
　　汉兵既擒许、典二将，乘胜下了钜鹿。典升部兵走败常山，告说："典将军与许总兵共守钜鹿，犄角立寨，不能轻犯，乃用诡计偷渡过河，诈袭常山，将兵埋伏各处，赚我等过河救应，俱被汉兵围住，活擒去了。"太守程杇听言大惊，曰："二将若还被擒，钜鹿必破，汉兵不日将至此间矣。"急请守将副帅张牛商议战守之策。张牛曰："贼兵若破钜鹿，定然来寇常山。此常山郡右连太行，左接瀛海，表山带河，当燕赵之冲，乃北郡之要，决不可失者。府尊乃程仲德之孙，代多智谋，高见以为何如？"杇曰："蒙将军大才下问，别无他计，依某愚见，一面点兵民运砖石守护，且将堞濠堑俱以修筑完备。但再遣一人，驰檄往兖州刺史苟道将军处求救，则可以保固此地也。"张牛从之，连夜使人持檄去求苟晞救援。苟晞接檄书看之，大惊曰："常山，吾之邻郡，冀北屏障，不可不救者。"乃命其追风团练使、屯操大将军乐房领兵五千，先往常山救应，命扎营于界口，以张声势。汉元帅刘聪自发钜鹿，将到常山，探马报道："兖州刺史苟晞差一大将带兵来救常山，今在东界屯扎。"张宾听说，即问众曰："谁人肯往东路去阻兖兵，莫与常山张牛相合，我等好去围城？"忽见马上有两人齐声应道："愿往！"乃是右先锋刘灵、右军都尉杨兴宝也。刘玄明大喜曰："二将肯去，一同带兵前往，看强弱而后可以进战，勿得有误。"二人领命，带轻兵五千，望东径至乐房寨前，相近扎下。乐房见其轻己，即与副将胡祯将人马出寨布阵，刘灵也排开阵势。三通鼓罢，乐房出马，指汉将曰："你等夺一平阳、钜鹿，反乱大朝，罪恶重极矣！又欲侵寇常山，是不自谅也！今我朝中齐王、成都、长沙、东海诸宗室，已皆大会军兵，不日到此，及早退去，犹保故土。"刘灵曰："你是何人，敢来此处以言语思退吾大军乎？"房曰："吾乃三世将家乐进之孙、乐綝之子乐房是也。"刘灵曰："说是如此，你乃先世仇种，今来寻我，是偿祖父宿债耳。可即速下马谢罪，免我动手。"乐房听言大怒，即便挥刀砍过汉阵，刘灵挺长矛接住。二人各施武勇，大展雄威，恶斗上三十馀合，未分胜败。晋副将胡祯见灵善战，挺枪从旁攻入。汉阵上杨兴宝看见大怒，手舞铁锤，飞步而出，如奔电，匹若轰雷，风卷打入，军士交横乱倒，逼近乐房马后。房惧马失，望前跑避，杨兴宝随后赶去，大喝："休走！"乐房回头看之，遥见胡祯战刘灵不过，被刺落马，叹惜一声。杨兴宝已追将及，慌忙举刀砍敌，未及五合，被杨兴宝一锤打中后胯，连人连马俱倒，兴宝一锤再去，正中顶门，死于非命。兵士皆奔还山东而去。
　　
　　刘灵二人找了房、祯首级，径到常山城下恐吓张牛。牛与程杇日夜严守，汉设云梯弓弩射上。牛、杇亲自指挥守御川谷，汉兵反被击死无算。一连十馀日，并无寸功。刘玄明与诸将议曰："常山城池又坚，守御又能，顿兵历旬，攻取不克，倘晋朝再差重臣提兵来救，又与雍州无异，前功悉弃矣。汝等有何奇计，宜速言之，论功第一。"张宾曰："兵贵神速，迟则有变。来日众兵将分一半往东南角上大张声势，用力攻打，以诱晋兵。吾造炮架十馀处，至黄昏时候，军士各要囊沙束草，一齐推至城下，架起襄阳大炮，打坏城垛，然后以沙囊草束相间堆起，腾涌而上，用强弓硬弩射退守兵。一得登城，彼兵必乱，乘乱砍开城门，大军一入，程杇、张牛即不能走矣。"刘聪深然其议，即命张宾提调制造器具齐备，以军士一半在寨伺候，一半往东南攻城。次日天早就出，程杇、张牛见汉兵皆从东南角尽力攻打，乃尽率城中精卒往二门婴城战守，西北上以百姓执械守之。两军于城上城下以石矢奋击，死伤甚众。挨至日晚，张宾命军士将炮架推至城下，架起襄阳子母炮十馀处，一齐放动，犹如天崩地裂一般，声闻数十里。程杇听得，带弓箭手五百人缘城来看。至西门，正见汉军在那里堆草扒城，乃命军士见有坏处守住射之，又命百姓拚死以砖石抛打。堆草之上，人立不稳，塌去者数处，汉兵跌饬数百。杇见汉众不退，遣人报知张牛。牛即分付军士曰："此处城垣牢固，贼心不在此处，明是牵引我的，你等为我守之。"言讫，分兵五百，如飞赶至北门，见汉兵犹在对拒，牛乃命众尽力射之。汉兵抵当不住，悉皆退去。张宾见士卒受伤，遂收入寨。张牛曰："今得程公射退贼兵，获保常山，莫大之功矣。"程杇曰："未足为功，贼虽暂退，为夜晚天黑也。彼见城墙打坏数处，明日刘聪必然大至，难与为敌矣。宜思一计策，破他一阵，方可再守。"张牛曰："府尊之言甚善。今城将坏，非用良谋，安能以寡敌众？吾二人今已时刻不可少离。吾有一计，可命吾侄张廉、牙将刘雄带领兵士二千，趁今兵退，即偷出城，将城河上流闸住。若是明日刘聪亲来之时，放炮为号，决闸放水，待其一涌而至，水势若汹，命其沿河杀转，我等自内杀出，可擒刘聪矣。"程杇曰："此计大妙，速宜行之。"张牛乃唤二将，分付以闸水之计："我这里城上待其兵到，即便放炮，招号决水。若是水势汹涌，汝便也放号炮，随流杀下，我等好出城接应，以擒贼将。"二人领计，乘空出城，去上流将河口塞住，水高丈馀，二人大喜。
　　
　　却说张宾收兵入营，刘聪曰："今此一计已甚如意，又被贼奴一番弓箭射退我军扒兵数百，以致大功垂成而不克，惜哉，惜哉！来日可要齐心协力，定要攻破常山，不可再误。吾当亲自临城，莫使其修补城垣，头上又起。"张宾乃命安排各件器具齐整。次早，关防、黄臣、张实三人屯兵城外，以防冲战，其馀将士皆随元帅刘聪至城下攻打。张牛、程杇亲上城头防守，见刘聪自在指点军士以锹攻掘。时将近巳，牛乃放起号炮。张廉、刘雄听得，放闸决水，沿河两岸水深四五尺，河中平高丈馀，势如海潮，乃亦放炮，沿河杀下。汉兵正在发喊，忽听得汛声如雷，一似万马奔腾，大水涌至。汉兵乱窜，立脚不住，涌入河中者尸漂叠叠。刘聪、张宾皆陷入濠中，马几没背。上流头张廉、刘雄掩下，城中张牛、程杇、程灼杀出，汉将马皆奔逸，各不相顾。程灼见一金盔金甲者在水中觅岸而上，知是刘聪，遂飞马赶去。张宾大叫曰："有贼暗算元帅，谁能救主？"程灼将到，奈水深不能近前，遂取弓拔箭，思欲射之。未及举手，一员虎将飞步向前，从背后大喝曰："贼子休得无礼，杨将军来也！"程灼回看，杨兴宝已逼至近。程灼欺其无马，下衣俱湿，按住了弓，挺枪便刺。兴宝见晋兵背后喊声甚急，奋力狠战，不分合数，只顾卷入，一锤击中马颈，程灼连人撞入水中。兴宝欲向岸边去打，已被推去数丈。程灼甲重，沉溺而死。兴宝遂把住岸口，喝军士扶救元帅，众皆下水。水势甚急，淹去者数人，扯得刘玄明上岸。张牛飞马赶来，却得汉将李瓒战住。兵士又救得张宾登岸，马皆未曾得起。张牛看见，撇了李瓒，来擒刘聪。兴宝拒住与战，不防一脚踹入水坎，被张牛一枪刺中手腕，兴宝拽锤而走，思引张牛，免伤聪、宾。张牛不赶，径取聪、宾，刘聪挥刀步战，张宾亦拔剑双抵。正在危迫，王弥看见，飞马来救，晋将刘雄拒住。雄方少怯，张廉又到，协力把王弥抵住。关谨绕城而至，见张牛逼住刘聪，不顾王弥，直前而去，高声大叫曰："勿得无礼，关将军在此！"张牛见其人紫面长须，手持青龙大刀，威如猛虎，料是非常，乃撇聪、宾，着意迎敌，战不十合，渐渐力怯，放马赶去。张宾高叫曰："除得此人，则常山方能得下！"关谨听得，遂紧追去。王弥被二将拒于中路，不能去救刘聪，见关谨马过，心中大怒，奋起神威，号吼逼进，馘斩刘雄于马下。张廉不退，反欲抢来报仇，弥张目叱曰："魍魉匹夫，许戌尚惧王飞豹，擒典升如抱孩提，走犹迟，敢来讨死也？"猛喝一声，夹马迫入。张廉不能展手，被王弥轻伸虎臂，生擒过马，令人捆起，送见刘聪。众将皆集，咸劝刘聪入寨更衣。聪曰："吾所惧者张、程二贼不肯出城，今彼恃此决水之计，思欲胜我，皆出在外，趁此已斩三将，将各门把住，不容再进，城可下也。"诸将即皆翻身赶杀晋兵，去抢城门。关谨追逐张牛自北门外起，转西而走，关谨不舍，周回一匝。张牛无奈，只得立马再战，才及五合，被谨大喝一声，手起处，把张牛照头劈开，顶分两半，倒于马下。副将四员奔散，关谨乘势赶去，见其皆从城缺处扒入，谨亦驰马骋上，副将挡住，被谨杀死两个，馀皆退去。谨登及城上，兵民砖石刀枪攒至，关谨冒石矢交砍，纷纷乱倒，如刈草芥，尽皆奔散。有副将六员，摆于城畔，把住登城之路，不容其下。关谨大吼，冲入其阵，一刀一个，连斩五员落马，馀皆披靡奔溃。汉众不知关谨杀进常山，只在各门攻打。谨至西门，皆是大木植隘住的，遂复杀转北门，砍开锁钮，放进汉兵。王弥在东门攻打，见城上竖起汉旗，小军急报曰："我兵已入城矣。此内皆是大木塞住不能陷者，可往北门而进。"弥悔曰："吾为先锋，守株此地，以致大功反为他将所建！"遂引兵北转。正遇程杇欲逃往洛，弥即跃马截住，程杇亦舞刀抵战，不及十合，朽便手慌刀乱，被王弥步步逼进，敌之不住，生擒过马，因自喜曰："吾虽不能救元帅，先破城，斩刘雄、捉张廉，又擒程杇，亦可以言功矣。"乃即押入城，直至府第。刘聪见之大喜，曰："吾为此二贼耽了许多忧虑，坏了许多军马，若使走去，则不能慎忠忠义之魂矣！先锋今能生致程杇，功可尚哉！功可尚哉！"弥曰："臣见张牛、刘雄来并殿下，驰斩逆贼，又遇张廉，虽获擒彼，有失救驾，何敢言功？"聪曰："去薪则釜不沸，吾自知之。"王弥大喜，谨谢而退。张宾乃令出榜安民，不拘守将家眷人等，一概不许侵扰，军士妄取一钱者，皆军法。城中安堵如故，百姓大悦，倾心为氓。聪命军政计点人马，前后射伤并淹没者共八千馀，折了樊荣、胡文盛二将，众皆垂泪，伤感不已。聪遂命将张廉、程杇沥血以祭诸亡将士。后人有诗一首，叹程杇附晋遭酷刑之报云：
　　
　　程昱先年助魏时，频将奸计献说腴。子孙剖腹遭凶戮，天理昭彰报不虚。
　　
